% Tester to sort circles for variable operation region

%rated rotor speed is 1.25!!!
%Rated pitch = 11 at wind speed = 15 m/s
%Rated pitch = 17 at wind speed = 20 m/s
%Rated pitch = 23 at wind speed = 25 m/s
clear all
close all

p_20 = 9.5; %pitch for 20/1.4 = 14.3 m/s (allows for 50 year gusts)
p_25 = 14.5;%pitch for 25/1.4 = 17.86 m/s
p_30 = 19.5; %pitch for 30/1.4 = 21.43 m/s
p_35 = 23; %pitch


% r_35 = 15^0.5; %was 1.8 (and pitch centre at 23) (and radius of 8)
% r_20 = 28^0.5; %was 7
% 
% 
% %r_25 = ;
% dif = r_20-r_35;
% 
% g_x0_plot = @(x1,x2,v_wind) ((x1-1.15).^2/(0.163^2) + (x2-35).^2/(6^2)) - (r_35+dif*7/3 - v_wind.*dif/15).^2;

r_35 = 1.8^0.5;
r_21 = 9^0.5;
dif = r_21-r_35;
g_x0_plot = @(x1,x2,v_wind)((x1-1.26).^2/(0.163^2) + (x2-25).^2/(5^2)) - (r_35+dif*2.5 - v_wind*dif/14).^2; % = 1


g_x0_plot_25 = @(x1,x2) g_x0_plot(x1,x2,25);
g_x0_plot_30 = @(x1,x2) g_x0_plot(x1,x2,30);
g_x0_plot_35 = @(x1,x2) g_x0_plot(x1,x2,35);


%     spds_1 = [0.494750000000000;0.510750000000000;0.526750000000000;0.542750000000000;0.558750000000000;0.574750000000000;0.590750000000000;0.606750000000000;0.622750000000000;0.638750000000000;0.654750000000000;0.670750000000000;0.686750000000000;0.702750000000000;0.718750000000000;0.734750000000000;0.750750000000000;0.766750000000000;0.782750000000000;0.798750000000000;0.814750000000000;0.830750000000000;0.846750000000000;0.862750000000000;0.878750000000000;0.894750000000000;0.910750000000000;0.926750000000000;0.942750000000000;0.958750000000000;0.974750000000000;0.990750000000000;1.00675000000000;1.02275000000000;1.03875000000000;1.05475000000000;1.07075000000000;1.08675000000000;1.10275000000000;1.11875000000000;1.13475000000000;1.15075000000000;1.16675000000000;1.18275000000000;1.19875000000000;1.21475000000000;1.23075000000000;1.24675000000000;1.26275000000000;1.27875000000000;1.29475000000000;1.31075000000000;1.32675000000000;1.34275000000000;1.35875000000000;1.37475000000000;1.39075000000000;1.40675000000000;1.42275000000000;1.43875000000000;1.45475000000000;1.47075000000000;1.48675000000000;1.50275000000000;1.51875000000000;1.53475000000000;1.55075000000000;1.56675000000000;1.58275000000000;1.59875000000000;1.61475000000000;1.63075000000000;1.64675000000000;1.66275000000000;1.67875000000000;1.69475000000000;1.71075000000000;1.72675000000000;1.74275000000000;1.75875000000000;1.77475000000000;1.79075000000000;1.80675000000000;1.82275000000000;1.83875000000000;1.85475000000000;1.87075000000000;1.88675000000000;1.90275000000000;1.91875000000000;1.93475000000000;1.95075000000000;1.96675000000000;1.98275000000000;1.99875000000000;2.01475000000000];
%     pitchs_1 = [5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5.32000000000000;5.64000000000000;5.64000000000000;5.96000000000000;6.28000000000000;6.28000000000000;6.60000000000000;6.60000000000000;6.92000000000000;7.24000000000000;7.24000000000000;7.56000000000000;7.56000000000000;7.88000000000000;8.20000000000000;8.20000000000000;8.52000000000000;8.52000000000000;8.84000000000000;9.16000000000000;9.16000000000000;9.48000000000000;9.48000000000000;9.80000000000000;10.1200000000000;10.1200000000000;10.4400000000000;10.4400000000000;10.7600000000000;11.0800000000000;11.0800000000000;11.4000000000000;11.7200000000000;11.7200000000000;12.0400000000000;12.3600000000000;12.3600000000000;12.6800000000000;13;13;13.3200000000000;13.6400000000000;13.9600000000000;13.9600000000000;14.2800000000000;14.6000000000000;14.9200000000000;15.2400000000000;15.5600000000000;15.8800000000000;16.2000000000000;16.5200000000000;16.8400000000000;17.4800000000000;17.8000000000000;18.4400000000000;19.0800000000000;20.3600000000000];
%elseif v_wind == 25
    %25 m/s
    spds_1 = [0.494750000000000;0.510750000000000;0.526750000000000;0.542750000000000;0.558750000000000;0.574750000000000;0.590750000000000;0.606750000000000;0.622750000000000;0.638750000000000;0.654750000000000;0.670750000000000;0.686750000000000;0.702750000000000;0.718750000000000;0.734750000000000;0.750750000000000;0.766750000000000;0.782750000000000;0.798750000000000;0.814750000000000;0.830750000000000;0.846750000000000;0.862750000000000;0.878750000000000;0.894750000000000;0.910750000000000;0.926750000000000;0.942750000000000;0.958750000000000;0.974750000000000;0.990750000000000;1.00675000000000;1.02275000000000;1.03875000000000;1.05475000000000;1.07075000000000;1.08675000000000;1.10275000000000;1.11875000000000;1.13475000000000;1.15075000000000;1.16675000000000;1.18275000000000;1.19875000000000;1.21475000000000;1.23075000000000;1.24675000000000;1.26275000000000;1.27875000000000;1.29475000000000;1.31075000000000;1.32675000000000;1.34275000000000;1.35875000000000;1.37475000000000;1.39075000000000;1.40675000000000;1.42275000000000;1.43875000000000;1.45475000000000;1.47075000000000;1.48675000000000;1.50275000000000;1.51875000000000;1.53475000000000;1.55075000000000;1.56675000000000;1.58275000000000;1.59875000000000;1.61475000000000;1.63075000000000;1.64675000000000;1.66275000000000;1.67875000000000;1.69475000000000;1.71075000000000;1.72675000000000;1.74275000000000;1.75875000000000;1.77475000000000;1.79075000000000;1.80675000000000;1.82275000000000;1.83875000000000;1.85475000000000;1.87075000000000;1.88675000000000;1.90275000000000;1.91875000000000;1.93475000000000;1.95075000000000;1.96675000000000;1.98275000000000;1.99875000000000;2.01475000000000];
    pitchs_1 = [5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5.32000000000000;5.64000000000000;5.96000000000000;6.28000000000000;6.28000000000000;6.60000000000000;6.92000000000000;7.24000000000000;7.24000000000000;7.56000000000000;7.88000000000000;7.88000000000000;8.20000000000000;8.52000000000000;8.52000000000000;8.84000000000000;8.84000000000000;9.16000000000000;9.48000000000000;9.48000000000000;9.80000000000000;9.80000000000000;10.1200000000000;10.4400000000000;10.4400000000000;10.7600000000000;10.7600000000000;11.0800000000000;11.0800000000000;11.4000000000000;11.7200000000000;11.7200000000000;12.0400000000000;12.0400000000000;12.3600000000000;12.3600000000000;12.6800000000000;13;13;13.3200000000000;13.3200000000000;13.6400000000000;13.6400000000000;13.9600000000000;14.2800000000000;14.2800000000000;14.6000000000000;14.6000000000000;14.9200000000000;15.2400000000000;15.2400000000000;15.5600000000000;15.5600000000000;15.8800000000000;16.2000000000000;16.2000000000000;16.5200000000000;16.8400000000000;16.8400000000000;17.1600000000000;17.4800000000000;17.8000000000000;17.8000000000000;18.1200000000000;18.4400000000000;18.7600000000000;19.0800000000000;19.4000000000000;19.7200000000000;20.0400000000000;20.3600000000000;21;21.6400000000000;22.2800000000000;23.2400000000000];
%else
%30 m/s
spds_2 = [0.494750000000000;0.510750000000000;0.526750000000000;0.542750000000000;0.558750000000000;0.574750000000000;0.590750000000000;0.606750000000000;0.622750000000000;0.638750000000000;0.654750000000000;0.670750000000000;0.686750000000000;0.702750000000000;0.718750000000000;0.734750000000000;0.750750000000000;0.766750000000000;0.782750000000000;0.798750000000000;0.814750000000000;0.830750000000000;0.846750000000000;0.862750000000000;0.878750000000000;0.894750000000000;0.910750000000000;0.926750000000000;0.942750000000000;0.958750000000000;0.974750000000000;0.990750000000000;1.00675000000000;1.02275000000000;1.03875000000000;1.05475000000000;1.07075000000000;1.08675000000000;1.10275000000000;1.11875000000000;1.13475000000000;1.15075000000000;1.16675000000000;1.18275000000000;1.19875000000000;1.21475000000000;1.23075000000000;1.24675000000000;1.26275000000000;1.27875000000000;1.29475000000000;1.31075000000000;1.32675000000000;1.34275000000000;1.35875000000000;1.37475000000000;1.39075000000000;1.40675000000000;1.42275000000000;1.43875000000000;1.45475000000000;1.47075000000000;1.48675000000000;1.50275000000000;1.51875000000000;1.53475000000000;1.55075000000000;1.56675000000000;1.58275000000000;1.59875000000000;1.61475000000000;1.63075000000000;1.64675000000000;1.66275000000000;1.67875000000000;1.69475000000000;1.71075000000000;1.72675000000000;1.74275000000000;1.75875000000000;1.77475000000000;1.79075000000000;1.80675000000000;1.82275000000000;1.83875000000000;1.85475000000000;1.87075000000000;1.88675000000000;1.90275000000000;1.91875000000000;1.93475000000000;1.95075000000000;1.96675000000000;1.98275000000000;1.99875000000000;2.01475000000000];
pitchs_2 = [5;5;5;5;5;5;5;5;5;5;5;5.32000000000000;5.96000000000000;6.28000000000000;6.60000000000000;7.24000000000000;7.56000000000000;7.88000000000000;8.20000000000000;8.52000000000000;8.84000000000000;8.84000000000000;9.16000000000000;9.48000000000000;9.80000000000000;10.1200000000000;10.1200000000000;10.4400000000000;10.7600000000000;10.7600000000000;11.0800000000000;11.4000000000000;11.4000000000000;11.7200000000000;12.0400000000000;12.0400000000000;12.3600000000000;12.3600000000000;12.6800000000000;13;13;13.3200000000000;13.3200000000000;13.6400000000000;13.6400000000000;13.9600000000000;14.2800000000000;14.2800000000000;14.6000000000000;14.6000000000000;14.9200000000000;14.9200000000000;15.2400000000000;15.2400000000000;15.5600000000000;15.5600000000000;15.8800000000000;15.8800000000000;16.2000000000000;16.5200000000000;16.5200000000000;16.8400000000000;16.8400000000000;17.1600000000000;17.1600000000000;17.4800000000000;17.4800000000000;17.8000000000000;17.8000000000000;18.1200000000000;18.4400000000000;18.4400000000000;18.7600000000000;18.7600000000000;19.0800000000000;19.4000000000000;19.4000000000000;19.7200000000000;19.7200000000000;20.0400000000000;20.3600000000000;20.3600000000000;20.6800000000000;21;21.3200000000000;21.6400000000000;21.6400000000000;21.9600000000000;22.2800000000000;22.6000000000000;22.9200000000000;23.2400000000000;23.8800000000000;24.2000000000000;24.8400000000000;25.8000000000000];  
%35 m/s
    spds_3 = [0.494750000000000;0.510750000000000;0.526750000000000;0.542750000000000;0.558750000000000;0.574750000000000;0.590750000000000;0.606750000000000;0.622750000000000;0.638750000000000;0.654750000000000;0.670750000000000;0.686750000000000;0.702750000000000;0.718750000000000;0.734750000000000;0.750750000000000;0.766750000000000;0.782750000000000;0.798750000000000;0.814750000000000;0.830750000000000;0.846750000000000;0.862750000000000;0.878750000000000;0.894750000000000;0.910750000000000;0.926750000000000;0.942750000000000;0.958750000000000;0.974750000000000;0.990750000000000;1.00675000000000;1.02275000000000;1.03875000000000;1.05475000000000;1.07075000000000;1.08675000000000;1.10275000000000;1.11875000000000;1.13475000000000;1.15075000000000;1.16675000000000;1.18275000000000;1.19875000000000;1.21475000000000;1.23075000000000;1.24675000000000;1.26275000000000;1.27875000000000;1.29475000000000;1.31075000000000;1.32675000000000;1.34275000000000;1.35875000000000;1.37475000000000;1.39075000000000;1.40675000000000;1.42275000000000;1.43875000000000;1.45475000000000;1.47075000000000;1.48675000000000;1.50275000000000;1.51875000000000;1.53475000000000;1.55075000000000;1.56675000000000;1.58275000000000;1.59875000000000;1.61475000000000;1.63075000000000;1.64675000000000;1.66275000000000;1.67875000000000;1.69475000000000;1.71075000000000;1.72675000000000;1.74275000000000;1.75875000000000;1.77475000000000;1.79075000000000;1.80675000000000;1.82275000000000;1.83875000000000;1.85475000000000;1.87075000000000;1.88675000000000;1.90275000000000;1.91875000000000;1.93475000000000;1.95075000000000;1.96675000000000;1.98275000000000;1.99875000000000;2.01475000000000];
   pitchs_3 = [5;5;5;5;5;5;5;5;5.32000000000000;6.28000000000000;7.24000000000000;7.88000000000000;8.52000000000000;8.84000000000000;9.48000000000000;9.80000000000000;10.1200000000000;10.4400000000000;10.7600000000000;11.0800000000000;11.4000000000000;11.7200000000000;12.0400000000000;12.3600000000000;12.3600000000000;12.6800000000000;13;13.3200000000000;13.3200000000000;13.6400000000000;13.9600000000000;13.9600000000000;14.2800000000000;14.6000000000000;14.6000000000000;14.9200000000000;14.9200000000000;15.2400000000000;15.5600000000000;15.5600000000000;15.8800000000000;15.8800000000000;16.2000000000000;16.2000000000000;16.5200000000000;16.5200000000000;16.8400000000000;16.8400000000000;17.1600000000000;17.1600000000000;17.4800000000000;17.4800000000000;17.8000000000000;17.8000000000000;18.1200000000000;18.4400000000000;18.4400000000000;18.7600000000000;18.7600000000000;19.0800000000000;19.0800000000000;19.4000000000000;19.4000000000000;19.7200000000000;19.7200000000000;20.0400000000000;20.0400000000000;20.3600000000000;20.3600000000000;20.6800000000000;20.6800000000000;21;21;21.3200000000000;21.6400000000000;21.6400000000000;21.9600000000000;21.9600000000000;22.2800000000000;22.6000000000000;22.6000000000000;22.9200000000000;23.2400000000000;23.2400000000000;23.5600000000000;23.8800000000000;23.8800000000000;24.2000000000000;24.5200000000000;24.8400000000000;25.1600000000000;25.4800000000000;26.1200000000000;26.4400000000000;27.0800000000000;28.0400000000000];
%end
figure
%plot trajectories
%plot(spds,pitchs,'b')
%hold on
% [30,144,255]/256
% [0,0,139/256]
%[100,149,237]/256


%plot operation regions
%hold on
%fimplicit(g_x0_plot_20,[-3 3 -10 70],'b')
fimplicit(g_x0_plot_25,[-3 3 -10 70],'color',[100,149,237]/256)
hold on
fimplicit(g_x0_plot_30,[-3 3 -10 70],'color',[1, 0.647, 0])
hold on
fimplicit(g_x0_plot_35,[-3 3 -10 70],'color',[150, 75, 0]/256)
hold on
plot(spds_1,pitchs_1,'--','color',[100,149,237]/256)
hold on
plot(spds_2,pitchs_2,'--','color',[1, 0.647, 0])
hold on
plot(spds_3,pitchs_3,'--','color',[150, 75, 0]/256)


hold on
plot(1.26,p_25,'x','color',[100,149,237]/256)
hold on
plot(1.26,p_30,'x','color',[1, 0.647, 0])
hold on
plot(1.26,p_35,'x','color',[150, 75, 0]/256)


hold on
plot([2.025 2.025], [-10 90],'r')

xlim([0.5 2.3])
ylim([0 50])


xlabel('Rotor Speed (rad/s)')
ylabel('Blade Pitch (deg)')
%title('Operation Regions for variable wind speed')
legend('V_{ref}  = 18m/s','V_{ref}  = 21.5m/s','V_{ref}  = 25m/s','Fontsize',12)



